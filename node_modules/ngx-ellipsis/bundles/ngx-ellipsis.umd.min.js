!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("element-resize-detector")):"function"==typeof define&&define.amd?define("ngx-ellipsis",["exports","@angular/core","element-resize-detector"],t):t(e["ngx-ellipsis"]={},e.ng.core,null)}(this,function(e,r,n){"use strict";var t=function(){function s(e,t,i){this.elementRef=e,this.renderer=t,this.ngZone=i,this.applyOnWindowResize=!1,this.ellipsisContent=null,this.moreClickEmitter=new r.EventEmitter}return s.numericBinarySearch=function(e,t){for(var i,s=0,r=e,n=-1;s<=r;){t(i=~~((s+r)/2))?s=(n=i)+1:r=i-1}return n},s.prototype.ngAfterViewInit=function(){""===this.ellipsisCharacters&&(this.ellipsisCharacters="..."),0<this.moreClickEmitter.observers.length&&(this.ellipsisCharacters='<a href="#" class="ngx-ellipsis-more">'+this.ellipsisCharacters+"</a>"),this.ellipsisWordBoundaries||(this.ellipsisWordBoundaries=""),this.ellipsisWordBoundaries="["+this.ellipsisWordBoundaries.replace(/\\n/,"\n").replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"]",this.elem=this.elementRef.nativeElement,this.ellipsisContent?this.originalText=this.ellipsisContent:this.originalText||(this.originalText=this.elem.innerText),this.renderer.setProperty(this.elem,"innerHTML",""),this.innerElem=this.renderer.createElement("div"),this.renderer.addClass(this.innerElem,"ngx-ellipsis-inner");var e=this.renderer.createText(this.originalText);this.renderer.appendChild(this.innerElem,e),this.renderer.appendChild(this.elem,this.innerElem),this.addResizeListener(!0)},s.prototype.ngOnChanges=function(){this.elem&&"undefined"!=typeof this.ellipsisContent&&this.originalText!==this.ellipsisContent&&(this.originalText=this.ellipsisContent,this.applyEllipsis())},s.prototype.ngOnDestroy=function(){this.removeAllListeners()},s.prototype.removeAllListeners=function(){this.destroyMoreClickListener&&this.destroyMoreClickListener(),this.removeResizeListener()},s.prototype.addResizeListener=function(e){switch(void 0===e&&(e=!1),"undefined"==typeof this.resizeDetectionStrategy&&(this.resizeDetectionStrategy=""),this.resizeDetectionStrategy){case"window":this.applyOnWindowResize=!0,e&&this.applyEllipsis();break;case"element-resize-detector-object":this.addElementResizeListener(!1);break;default:"undefined"!=typeof console&&console.warn("No such ellipsis-resize-detection strategy: '"+this.resizeDetectionStrategy+"'. Using 'element-resize-detector' instead");case"element-resize-detector":case"":this.addElementResizeListener()}},s.prototype.onResize=function(e){var t=this;this.ngZone.run(function(){t.applyOnWindowResize&&t.applyEllipsis()})},s.prototype.addElementResizeListener=function(e){var t=this;(void 0===e&&(e=!0),s.elementResizeDetector)||(s.elementResizeDetector=n({strategy:e?"scroll":"object"}));var i=!1;s.elementResizeDetector.listenTo(this.elementRef.nativeElement,function(){i&&t.applyEllipsis()}),i=!0},s.prototype.removeResizeListener=function(){"window"!==this.resizeDetectionStrategy?s.elementResizeDetector&&this.elem&&s.elementResizeDetector.removeAllListeners(this.elem):this.applyOnWindowResize=!1},s.prototype.getTruncatedText=function(e){if(!this.originalText||this.originalText.length<=e)return this.originalText;var t=this.originalText.substr(0,e);if("[]"===this.ellipsisWordBoundaries||this.originalText.charAt(e).match(this.ellipsisWordBoundaries))return t+this.ellipsisCharacters;for(var i=e-1;0<i&&!t.charAt(i).match(this.ellipsisWordBoundaries);)i--;return t.substr(0,i)+this.ellipsisCharacters},s.prototype.truncateText=function(e,t){var i=this;void 0===t&&(t=!1);var s=this.getTruncatedText(e);this.renderer.setProperty(this.innerElem,"innerHTML",s),t&&(this.destroyMoreClickListener&&this.destroyMoreClickListener(),s!==this.originalText&&(this.destroyMoreClickListener=this.renderer.listen(this.innerElem,"click",function(e){e.target&&"ngx-ellipsis-more"===e.target.className&&(e.preventDefault(),i.moreClickEmitter.emit(e))})))},s.prototype.applyEllipsis=function(){var t=this;this.removeResizeListener();var e=s.numericBinarySearch(this.originalText.length,function(e){return t.truncateText(e),!t.isOverflowing});this.truncateText(e,0<this.moreClickEmitter.observers.length),this.addResizeListener()},Object.defineProperty(s.prototype,"isOverflowing",{get:function(){var e=this.elem.style.overflow;e&&"visible"!==e||(this.elem.style.overflow="hidden");var t=this.elem.clientWidth<this.elem.scrollWidth-1||this.elem.clientHeight<this.elem.scrollHeight-1;return this.elem.style.overflow=e,t},enumerable:!0,configurable:!0}),s.elementResizeDetector=null,s.decorators=[{type:r.Directive,args:[{selector:"[ellipsis]"}]}],s.ctorParameters=function(){return[{type:r.ElementRef},{type:r.Renderer2},{type:r.NgZone}]},s.propDecorators={ellipsisCharacters:[{type:r.Input,args:["ellipsis"]}],ellipsisContent:[{type:r.Input,args:["ellipsis-content"]}],ellipsisWordBoundaries:[{type:r.Input,args:["ellipsis-word-boundaries"]}],resizeDetectionStrategy:[{type:r.Input,args:["ellipsis-resize-detection"]}],moreClickEmitter:[{type:r.Output,args:["ellipsis-click-more"]}],onResize:[{type:r.HostListener,args:["window:resize",["$event"]]}]},s}(),i=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{imports:[],declarations:[t],exports:[t]}]}],e}();e.EllipsisDirective=t,e.EllipsisModule=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-ellipsis.umd.min.js.map